<template>
  <div class = "gameboard">
    <div class="step"><br>{{steps}}</div>
    <input id="lastLevel" type="button" v-on:click="changeLevel($event)">
    <div id="level"><br>{{level+1}}</div>
    <input id="nextLevel" type="button" v-on:click="changeLevel($event)">
    <input class="back" type="button" v-on:click="moveBack">
    <input class="solution" type="button" v-on:click="autoPlay">
    <input class="restart" type="button" v-on:click="replay">
    <!-- <input class="setting" type="button" v-on:click="userCreate($event)"> -->
    <v-row justify="center">
      <v-dialog
        v-model="dialog"
        persistent
        max-width="600px"
      >
        <template v-slot:activator="{ on, attrs }">
          <input class="setting" type="button" 
            v-bind="attrs"
            v-on="on"
          >
        </template>
        <v-card>
          <v-card-title>
            <span class="headline">Cusotmize Klotski puzzles</span>
          </v-card-title>
          <v-card-text>
            <v-container>
              <v-row>
                <v-col
                  cols="12"
                  sm="6"
                  md="4"
                >
                  <v-text-field
                    label="Maximum level (integer)"
                    v-model="maxLev"
                  ></v-text-field>
                </v-col>
                <v-col
                  cols="12"
                  sm="6"
                >
                  <v-select
                    :items="['1', '2', '3', '4','5']"
                    v-model="type"
                    label="* Type of Klotski (the number of 1x2 blocks)"
                    required
                  ></v-select>
                </v-col>
              </v-row>
            </v-container>
            <small>* indicates required field</small>
          </v-card-text>
          <v-card-actions>
            <v-spacer></v-spacer>
            <v-btn
              color="blue darken-1"
              text
              @click="dialog = false"
            >
              Close
            </v-btn>
            <v-btn
              color="blue darken-1"
              text
              @click="newPuzzles($event)"
            >
              Submit
            </v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>
    </v-row>
		<div class="sprite bg-kuang">
			<div id="game-klotski" style="position:relative;left:20px;top:20px;"></div>
		</div>
  </div>
</template>

<script>
//import { exec } from 'child_process'
import { generatePuzzles } from '../plugins/UserService'
  export default {
    name: 'Klotski',
    data () {
      return {
MAP:[
  [[0, 4, 4, 3], [1, 4, 4, 3], [3, 2, 2, 3], [3, 3, 0, 3], [1, 3, 1, 1]],
[[4, 4, 3, 0], [4, 4, 3, 0], [1, 3, 2, 2], [3, 3, 1, 3], [3, 1, 1, 3]],
[[3, 4, 4, 0], [3, 4, 4, 1], [3, 2, 2, 3], [3, 0, 3, 3], [1, 1, 3, 1]],
[[0, 3, 4, 4], [0, 3, 4, 4], [2, 2, 3, 1], [3, 1, 3, 3], [3, 1, 1, 3]],//1H, 4 config, 126 steps
[[3, 1, 1, 1], [3, 3, 4, 4], [3, 3, 4, 4], [3, 2, 2, 0], [2, 2, 1, 0]],
[[3, 1, 1, 1], [3, 3, 4, 4], [3, 3, 4, 4], [3, 2, 2, 1], [2, 2, 0, 0]],
[[3, 1, 1, 1], [3, 3, 4, 4], [3, 3, 4, 4], [3, 2, 2, 1], [0, 0, 2, 2]],
[[1, 1, 1, 3], [4, 4, 3, 3], [4, 4, 3, 3], [0, 2, 2, 3], [0, 1, 2, 2]],
[[1, 1, 1, 3], [4, 4, 3, 3], [4, 4, 3, 3], [1, 2, 2, 3], [0, 0, 2, 2]],
[[1, 1, 1, 3], [4, 4, 3, 3], [4, 4, 3, 3], [1, 2, 2, 3], [2, 2, 0, 0]],//2H, 6 config, 179 steps
[[4, 4, 0, 3], [4, 4, 1, 3], [0, 3, 2, 2], [1, 3, 2, 2], [1, 1, 2, 2]],
[[3, 0, 4, 4], [3, 1, 4, 4], [2, 2, 3, 0], [2, 2, 3, 1], [2, 2, 1, 1]],//3H, 2 config, 178 steps
[[1, 1, 4, 4], [2, 2, 4, 4], [0, 1, 2, 2], [2, 2, 3, 0], [2, 2, 3, 1]],
[[4, 4, 1, 1], [4, 4, 2, 2], [2, 2, 1, 0], [0, 3, 2, 2], [1, 3, 2, 2]],//4H, 2 config, 138 steps
[[1, 1, 4, 4], [2, 2, 4, 4], [2, 2, 2, 2], [0, 1, 2, 2], [2, 2, 1, 0]],
[[4, 4, 1, 1], [4, 4, 2, 2], [2, 2, 2, 2], [2, 2, 1, 0], [0, 1, 2, 2]],
[[0, 4, 4, 1], [0, 4, 4, 1], [2, 2, 1, 1], [2, 2, 2, 2], [2, 2, 2, 2]],
[[1, 4, 4, 0], [1, 4, 4, 0], [1, 1, 2, 2], [2, 2, 2, 2], [2, 2, 2, 2]],//5H, 4 config, 77 steps
],
sol:[
//1H
[[1,0,0],[4,2,0],[4,3,2],[2,3,1],[2,1,3],[3,1,0],[4,2,2],[2,0,0],[4,0,0],[4,1,2],[3,2,1],[2,1,1],[2,2,2],[3,3,0],[4,2,3],[3,1,3],[3,0,3],[1,0,1],[0,0,1],[4,0,3],[2,0,1],[1,0,1],[0,1,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[2,0,3],[3,0,0],[4,1,2],[3,1,1],[2,1,1],[4,3,0],[2,2,2],[3,3,0],[3,2,3],[4,1,3],[4,0,3],[2,0,1],[2,1,2],[0,2,1],[1,2,1],[0,3,2],[2,3,0],[3,3,0],[4,2,3],[1,3,0],[2,3,0],[4,3,0],[2,2,1],[0,2,1],[0,3,2],[1,3,0],[3,3,0],[3,2,3],[1,2,1],[2,2,1],[2,3,2],[2,2,0],[2,0,3],[3,0,0],[4,1,2],[3,1,1],[2,1,3],[2,0,3],[4,0,0],[4,1,2],[2,1,1],[2,2,2],[0,3,1],[0,2,3],[1,2,0],[2,1,2],[3,2,0],[2,2,0],[3,1,3],[3,0,3],[3,1,1],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[3,2,0],[4,1,3],[4,0,3],[1,3,0],[3,3,0],[4,2,3],[4,1,3],[3,0,1],[1,0,1],[0,1,1],[1,1,2],[0,2,2],[2,2,0],[1,2,0],[2,0,3],[1,0,1],[0,0,1],[2,0,1],[1,0,1],[0,1,2],[0,2,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[2,0,3],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,1,3],[2,2,3],[2,0,3],[2,1,3],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
[[0,2,3],[0,0,3],[2,0,0],[1,0,0],[3,0,0],[4,1,2],[4,2,2],[2,0,0],[4,0,0],[4,1,2],[3,2,1],[2,1,1],[2,2,2],[3,3,0],[4,2,3],[3,1,3],[3,0,3],[1,0,1],[0,0,1],[4,0,3],[2,0,1],[1,0,1],[0,1,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[2,0,3],[3,0,0],[4,1,2],[3,1,1],[2,1,1],[4,3,0],[2,2,2],[3,3,0],[3,2,3],[4,1,3],[4,0,3],[2,0,1],[2,1,2],[0,2,1],[1,2,1],[0,3,2],[2,3,0],[3,3,0],[4,2,3],[1,3,0],[2,3,0],[4,3,0],[2,2,1],[0,2,1],[0,3,2],[1,3,0],[3,3,0],[3,2,3],[1,2,1],[2,2,1],[2,3,2],[2,2,0],[2,0,3],[3,0,0],[4,1,2],[3,1,1],[2,1,3],[2,0,3],[4,0,0],[4,1,2],[2,1,1],[2,2,2],[0,3,1],[0,2,3],[1,2,0],[2,1,2],[3,2,0],[2,2,0],[3,1,3],[3,0,3],[3,1,1],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[3,2,0],[4,1,3],[4,0,3],[1,3,0],[3,3,0],[4,2,3],[4,1,3],[3,0,1],[1,0,1],[0,1,1],[1,1,2],[0,2,2],[2,2,0],[1,2,0],[2,0,3],[1,0,1],[0,0,1],[2,0,1],[1,0,1],[0,1,2],[0,2,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[2,0,3],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,1,3],[2,2,3],[2,0,3],[2,1,3],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
[[1,3,0],[4,1,0],[4,0,3],[2,0,1],[2,1,2],[3,2,0],[4,1,3],[2,3,0],[4,3,0],[4,2,3],[3,1,1],[2,2,1],[2,0,3],[3,0,0],[4,1,2],[3,2,2],[3,3,2],[1,3,1],[0,3,1],[4,3,2],[2,3,1],[1,3,1],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[2,3,2],[3,3,0],[4,2,3],[3,2,1],[2,2,1],[4,0,0],[2,0,3],[3,0,0],[3,1,2],[4,2,2],[4,3,2],[2,3,1],[2,1,3],[0,1,1],[1,1,1],[0,0,3],[2,0,0],[3,0,0],[4,1,2],[1,0,0],[2,0,0],[4,0,0],[2,1,1],[0,1,1],[0,0,3],[1,0,0],[3,0,0],[3,1,2],[1,1,1],[2,1,1],[2,0,3],[2,1,0],[2,2,2],[3,3,0],[4,2,3],[3,2,1],[2,1,2],[2,3,2],[4,3,0],[4,2,3],[2,2,1],[2,0,3],[0,0,1],[0,1,2],[1,1,0],[2,1,3],[3,1,0],[2,1,0],[3,2,2],[3,3,2],[3,2,1],[2,2,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,1,0],[3,1,0],[4,2,2],[4,3,2],[1,0,0],[3,0,0],[4,1,2],[4,2,2],[3,2,1],[1,2,1],[0,2,1],[1,2,3],[0,1,3],[2,1,0],[1,1,0],[2,2,2],[1,3,1],[0,3,1],[2,3,1],[1,3,1],[0,2,3],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[3,3,2],[3,2,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,3,2],[2,1,2],[2,2,2],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[0,1,2],[0,2,2],[2,3,0],[1,3,0],[3,3,0],[4,2,3],[4,1,3],[2,3,0],[4,3,0],[4,2,3],[3,1,1],[2,2,1],[2,0,3],[3,0,0],[4,1,2],[3,2,2],[3,3,2],[1,3,1],[0,3,1],[4,3,2],[2,3,1],[1,3,1],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[2,3,2],[3,3,0],[4,2,3],[3,2,1],[2,2,1],[4,0,0],[2,0,3],[3,0,0],[3,1,2],[4,2,2],[4,3,2],[2,3,1],[2,1,3],[0,1,1],[1,1,1],[0,0,3],[2,0,0],[3,0,0],[4,1,2],[1,0,0],[2,0,0],[4,0,0],[2,1,1],[0,1,1],[0,0,3],[1,0,0],[3,0,0],[3,1,2],[1,1,1],[2,1,1],[2,0,3],[2,1,0],[2,2,2],[3,3,0],[4,2,3],[3,2,1],[2,1,2],[2,3,2],[4,3,0],[4,2,3],[2,2,1],[2,0,3],[0,0,1],[0,1,2],[1,1,0],[2,1,3],[3,1,0],[2,1,0],[3,2,2],[3,3,2],[3,2,1],[2,2,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,1,0],[3,1,0],[4,2,2],[4,3,2],[1,0,0],[3,0,0],[4,1,2],[4,2,2],[3,2,1],[1,2,1],[0,2,1],[1,2,3],[0,1,3],[2,1,0],[1,1,0],[2,2,2],[1,3,1],[0,3,1],[2,3,1],[1,3,1],[0,2,3],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[3,3,2],[3,2,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,3,2],[2,1,2],[2,2,2],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
//2H
[[3,1,3],[1,1,1],[0,1,1],[0,2,2],[0,3,2],[4,2,3],[4,0,3],[2,0,1],[0,0,1],[0,1,2],[0,2,2],[1,2,0],[3,2,0],[4,3,0],[4,1,3],[2,1,1],[1,1,1],[0,1,1],[0,0,3],[1,0,0],[2,1,2],[3,1,0],[4,2,2],[3,3,1],[2,2,1],[0,2,1],[0,1,3],[1,1,0],[0,2,3],[0,1,3],[2,1,0],[1,1,0],[2,0,3],[2,1,1],[0,1,1],[0,2,2],[0,0,1],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[3,2,0],[4,3,0],[4,1,3],[3,1,1],[3,3,2],[3,2,2],[2,2,1],[0,2,1],[0,1,3],[0,0,3],[0,2,3],[0,1,3],[1,1,0],[3,1,0],[4,1,0],[1,0,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[3,1,3],[2,1,1],[0,1,1],[0,2,2],[3,2,3],[3,1,3],[1,1,1],[0,1,1],[0,3,2],[0,2,2],[1,2,0],[3,3,0],[3,2,3],[2,1,3],[2,0,3],[0,0,1],[0,1,2],[1,1,0],[2,1,0],[4,0,0],[4,2,2],[3,3,1],[2,3,1],[4,1,2],[4,3,2],[3,3,1],[2,2,3],[4,2,0],[3,2,0],[3,0,3],[1,0,1],[4,0,3],[2,0,1],[1,1,2],[0,1,1],[1,1,1],[0,2,2],[2,3,0],[3,1,3],[2,1,1],[2,2,2],[1,3,0],[3,2,0],[3,1,3],[4,3,0],[4,1,3],[3,0,3],[1,0,1],[2,0,1],[2,1,2],[2,2,2],[3,3,0],[2,0,0],[2,1,2],[2,3,2],[0,3,1],[1,3,1],[0,1,3],[0,0,3],[1,0,0],[2,0,0],[3,1,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[2,2,1],[2,3,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[2,1,0],[3,2,2],[4,2,0],[4,0,3],[2,0,1],[1,1,2],[1,2,2],[3,3,0],[4,1,3],[3,1,1],[3,2,2],[0,3,1],[0,2,3],[0,0,3],[1,0,0],[3,0,0],[4,1,2],[3,1,1],[1,1,1],[1,3,2],[0,3,1],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[1,2,1],[1,3,2],[2,3,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[0,1,1],[0,2,2],[1,3,0],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[3,3,1],[3,1,3],[1,1,1],[0,1,1],[0,2,2],[0,3,2],[4,0,3],[2,0,1],[0,0,1],[0,1,2],[0,2,2],[1,2,0],[3,2,0],[4,3,0],[4,1,3],[2,1,1],[1,1,1],[0,1,1],[0,0,3],[1,0,0],[2,1,2],[3,1,0],[4,2,2],[3,3,1],[2,2,1],[0,2,1],[0,1,3],[1,1,0],[0,2,3],[0,1,3],[2,1,0],[1,1,0],[2,0,3],[2,1,1],[0,1,1],[0,2,2],[0,0,1],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[3,2,0],[4,3,0],[4,1,3],[3,1,1],[3,3,2],[3,2,2],[2,2,1],[0,2,1],[0,1,3],[0,0,3],[0,2,3],[0,1,3],[1,1,0],[3,1,0],[4,1,0],[1,0,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[3,1,3],[2,1,1],[0,1,1],[0,2,2],[3,2,3],[3,1,3],[1,1,1],[0,1,1],[0,3,2],[0,2,2],[1,2,0],[3,3,0],[3,2,3],[2,1,3],[2,0,3],[0,0,1],[0,1,2],[1,1,0],[2,1,0],[4,0,0],[4,2,2],[3,3,1],[2,3,1],[4,1,2],[4,3,2],[3,3,1],[2,2,3],[4,2,0],[3,2,0],[3,0,3],[1,0,1],[4,0,3],[2,0,1],[1,1,2],[0,1,1],[1,1,1],[0,2,2],[2,3,0],[3,1,3],[2,1,1],[2,2,2],[1,3,0],[3,2,0],[3,1,3],[4,3,0],[4,1,3],[3,0,3],[1,0,1],[2,0,1],[2,1,2],[2,2,2],[3,3,0],[2,0,0],[2,1,2],[2,3,2],[0,3,1],[1,3,1],[0,1,3],[0,0,3],[1,0,0],[2,0,0],[3,1,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[2,2,1],[2,3,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[2,1,0],[3,2,2],[4,2,0],[4,0,3],[2,0,1],[1,1,2],[1,2,2],[3,3,0],[4,1,3],[3,1,1],[3,2,2],[0,3,1],[0,2,3],[0,0,3],[1,0,0],[3,0,0],[4,1,2],[3,1,1],[1,1,1],[1,3,2],[0,3,1],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[1,2,1],[1,3,2],[2,3,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[0,1,1],[0,2,2],[1,3,0],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[4,2,2],[3,3,1],[3,1,3],[1,1,1],[0,1,1],[0,2,2],[0,3,2],[2,0,1],[0,0,1],[0,1,2],[0,2,2],[1,2,0],[3,2,0],[4,3,0],[4,1,3],[2,1,1],[1,1,1],[0,1,1],[0,0,3],[1,0,0],[2,1,2],[3,1,0],[4,2,2],[3,3,1],[2,2,1],[0,2,1],[0,1,3],[1,1,0],[0,2,3],[0,1,3],[2,1,0],[1,1,0],[2,0,3],[2,1,1],[0,1,1],[0,2,2],[0,0,1],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[3,2,0],[4,3,0],[4,1,3],[3,1,1],[3,3,2],[3,2,2],[2,2,1],[0,2,1],[0,1,3],[0,0,3],[0,2,3],[0,1,3],[1,1,0],[3,1,0],[4,1,0],[1,0,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[3,1,3],[2,1,1],[0,1,1],[0,2,2],[3,2,3],[3,1,3],[1,1,1],[0,1,1],[0,3,2],[0,2,2],[1,2,0],[3,3,0],[3,2,3],[2,1,3],[2,0,3],[0,0,1],[0,1,2],[1,1,0],[2,1,0],[4,0,0],[4,2,2],[3,3,1],[2,3,1],[4,1,2],[4,3,2],[3,3,1],[2,2,3],[4,2,0],[3,2,0],[3,0,3],[1,0,1],[4,0,3],[2,0,1],[1,1,2],[0,1,1],[1,1,1],[0,2,2],[2,3,0],[3,1,3],[2,1,1],[2,2,2],[1,3,0],[3,2,0],[3,1,3],[4,3,0],[4,1,3],[3,0,3],[1,0,1],[2,0,1],[2,1,2],[2,2,2],[3,3,0],[2,0,0],[2,1,2],[2,3,2],[0,3,1],[1,3,1],[0,1,3],[0,0,3],[1,0,0],[2,0,0],[3,1,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[2,2,1],[2,3,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[2,1,0],[3,2,2],[4,2,0],[4,0,3],[2,0,1],[1,1,2],[1,2,2],[3,3,0],[4,1,3],[3,1,1],[3,2,2],[0,3,1],[0,2,3],[0,0,3],[1,0,0],[3,0,0],[4,1,2],[3,1,1],[1,1,1],[1,3,2],[0,3,1],[0,1,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[1,2,1],[1,3,2],[2,3,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[0,1,1],[0,2,2],[1,3,0],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[3,1,2],[1,2,1],[0,2,1],[0,1,3],[0,0,3],[4,1,2],[4,2,2],[2,3,1],[0,3,1],[0,2,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[4,1,2],[2,2,1],[1,2,1],[0,2,1],[0,3,2],[1,3,0],[2,2,3],[3,2,0],[4,0,3],[3,0,1],[2,0,1],[0,0,1],[0,2,2],[1,2,0],[0,1,2],[0,2,2],[2,2,0],[1,2,0],[2,3,2],[2,2,1],[0,2,1],[0,1,3],[0,3,1],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[4,1,2],[3,2,1],[3,0,3],[3,1,3],[2,0,1],[0,0,1],[0,2,2],[0,3,2],[0,1,2],[0,2,2],[1,2,0],[3,2,0],[4,2,0],[1,3,0],[3,3,0],[4,0,3],[4,1,3],[3,0,1],[3,2,2],[2,2,1],[0,2,1],[0,1,3],[3,1,2],[3,2,2],[1,2,1],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[3,1,2],[2,2,2],[2,3,2],[0,3,1],[0,2,3],[1,2,0],[2,2,0],[4,2,0],[4,0,3],[3,0,1],[2,0,1],[4,1,3],[4,0,3],[3,0,1],[2,1,2],[4,1,0],[3,1,0],[3,2,2],[1,3,1],[4,2,2],[2,3,1],[1,2,3],[0,2,1],[1,2,1],[0,0,3],[2,0,0],[3,1,2],[2,2,1],[2,1,3],[1,0,0],[3,0,0],[3,2,2],[4,0,0],[4,1,2],[3,3,2],[1,3,1],[2,3,1],[2,2,3],[2,0,3],[3,0,0],[2,3,0],[2,1,3],[2,0,3],[0,0,1],[1,0,1],[0,1,2],[0,3,2],[1,3,0],[2,2,0],[3,2,0],[3,3,0],[4,0,3],[4,1,3],[3,1,1],[2,1,1],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[2,2,0],[3,1,3],[4,1,0],[4,2,2],[2,3,1],[1,2,3],[1,0,3],[3,0,0],[4,1,2],[3,2,1],[3,1,3],[0,0,1],[0,1,2],[0,2,2],[1,3,0],[3,3,0],[4,2,3],[3,2,1],[1,1,1],[1,0,3],[0,0,1],[0,1,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[1,1,1],[1,0,3],[2,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,1,3],[2,2,3],[0,2,1],[0,0,3],[1,0,0],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
[[3,0,1],[3,1,2],[1,2,1],[0,2,1],[0,1,3],[0,0,3],[4,2,2],[2,3,1],[0,3,1],[0,2,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[4,1,2],[2,2,1],[1,2,1],[0,2,1],[0,3,2],[1,3,0],[2,2,3],[3,2,0],[4,0,3],[3,0,1],[2,0,1],[0,0,1],[0,2,2],[1,2,0],[0,1,2],[0,2,2],[2,2,0],[1,2,0],[2,3,2],[2,2,1],[0,2,1],[0,1,3],[0,3,1],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[4,1,2],[3,2,1],[3,0,3],[3,1,3],[2,0,1],[0,0,1],[0,2,2],[0,3,2],[0,1,2],[0,2,2],[1,2,0],[3,2,0],[4,2,0],[1,3,0],[3,3,0],[4,0,3],[4,1,3],[3,0,1],[3,2,2],[2,2,1],[0,2,1],[0,1,3],[3,1,2],[3,2,2],[1,2,1],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[3,1,2],[2,2,2],[2,3,2],[0,3,1],[0,2,3],[1,2,0],[2,2,0],[4,2,0],[4,0,3],[3,0,1],[2,0,1],[4,1,3],[4,0,3],[3,0,1],[2,1,2],[4,1,0],[3,1,0],[3,2,2],[1,3,1],[4,2,2],[2,3,1],[1,2,3],[0,2,1],[1,2,1],[0,0,3],[2,0,0],[3,1,2],[2,2,1],[2,1,3],[1,0,0],[3,0,0],[3,2,2],[4,0,0],[4,1,2],[3,3,2],[1,3,1],[2,3,1],[2,2,3],[2,0,3],[3,0,0],[2,3,0],[2,1,3],[2,0,3],[0,0,1],[1,0,1],[0,1,2],[0,3,2],[1,3,0],[2,2,0],[3,2,0],[3,3,0],[4,0,3],[4,1,3],[3,1,1],[2,1,1],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[2,2,0],[3,1,3],[4,1,0],[4,2,2],[2,3,1],[1,2,3],[1,0,3],[3,0,0],[4,1,2],[3,2,1],[3,1,3],[0,0,1],[0,1,2],[0,2,2],[1,3,0],[3,3,0],[4,2,3],[3,2,1],[1,1,1],[1,0,3],[0,0,1],[0,1,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[1,1,1],[1,0,3],[2,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,1,3],[2,2,3],[0,2,1],[0,0,3],[1,0,0],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
[[4,0,3],[3,0,1],[3,1,2],[1,2,1],[0,2,1],[0,1,3],[0,0,3],[2,3,1],[0,3,1],[0,2,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[4,1,2],[2,2,1],[1,2,1],[0,2,1],[0,3,2],[1,3,0],[2,2,3],[3,2,0],[4,0,3],[3,0,1],[2,0,1],[0,0,1],[0,2,2],[1,2,0],[0,1,2],[0,2,2],[2,2,0],[1,2,0],[2,3,2],[2,2,1],[0,2,1],[0,1,3],[0,3,1],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[4,1,2],[3,2,1],[3,0,3],[3,1,3],[2,0,1],[0,0,1],[0,2,2],[0,3,2],[0,1,2],[0,2,2],[1,2,0],[3,2,0],[4,2,0],[1,3,0],[3,3,0],[4,0,3],[4,1,3],[3,0,1],[3,2,2],[2,2,1],[0,2,1],[0,1,3],[3,1,2],[3,2,2],[1,2,1],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[3,1,2],[2,2,2],[2,3,2],[0,3,1],[0,2,3],[1,2,0],[2,2,0],[4,2,0],[4,0,3],[3,0,1],[2,0,1],[4,1,3],[4,0,3],[3,0,1],[2,1,2],[4,1,0],[3,1,0],[3,2,2],[1,3,1],[4,2,2],[2,3,1],[1,2,3],[0,2,1],[1,2,1],[0,0,3],[2,0,0],[3,1,2],[2,2,1],[2,1,3],[1,0,0],[3,0,0],[3,2,2],[4,0,0],[4,1,2],[3,3,2],[1,3,1],[2,3,1],[2,2,3],[2,0,3],[3,0,0],[2,3,0],[2,1,3],[2,0,3],[0,0,1],[1,0,1],[0,1,2],[0,3,2],[1,3,0],[2,2,0],[3,2,0],[3,3,0],[4,0,3],[4,1,3],[3,1,1],[2,1,1],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[2,2,0],[3,1,3],[4,1,0],[4,2,2],[2,3,1],[1,2,3],[1,0,3],[3,0,0],[4,1,2],[3,2,1],[3,1,3],[0,0,1],[0,1,2],[0,2,2],[1,3,0],[3,3,0],[4,2,3],[3,2,1],[1,1,1],[1,0,3],[0,0,1],[0,1,2],[0,3,2],[2,3,0],[1,3,0],[2,1,3],[1,1,1],[1,0,3],[2,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,1,3],[2,2,3],[0,2,1],[0,0,3],[1,0,0],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
//3H
[[3,0,0],[4,0,0],[1,2,0],[4,1,2],[2,1,1],[2,2,2],[0,3,1],[0,2,3],[0,0,3],[2,0,0],[1,0,0],[3,0,0],[2,0,0],[4,0,0],[3,0,0],[3,1,2],[3,2,2],[1,3,1],[0,3,1],[4,2,2],[2,3,1],[1,3,1],[0,1,3],[1,0,3],[1,1,0],[2,0,0],[1,0,3],[3,0,0],[2,0,0],[4,1,2],[3,1,2],[3,3,2],[2,3,1],[2,1,3],[1,1,1],[0,1,1],[0,0,3],[1,0,0],[2,1,2],[2,2,2],[3,3,0],[3,2,3],[3,0,3],[2,0,1],[2,1,2],[2,3,2],[4,0,3],[3,0,1],[3,1,2],[2,2,1],[2,0,3],[2,1,3],[3,0,0],[4,0,0],[4,1,2],[3,2,1],[3,0,3],[3,1,3],[2,0,1],[2,2,2],[2,1,2],[3,2,0],[4,2,0],[3,3,0],[4,0,3],[4,1,3],[3,0,1],[3,2,2],[2,2,1],[2,0,3],[0,0,1],[0,1,2],[1,0,1],[1,1,2],[0,2,2],[2,3,0],[3,2,3],[1,3,0],[3,3,0],[4,2,0],[4,0,3],[4,1,3],[3,1,1],[2,0,1],[2,1,2],[2,3,2],[0,3,1],[3,2,2],[1,3,1],[0,1,3],[0,0,3],[1,0,0],[2,0,0],[3,0,0],[4,1,2],[2,2,2],[4,2,2],[2,3,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[2,1,0],[1,1,2],[1,2,2],[0,3,1],[1,3,1],[0,2,3],[0,3,1],[0,0,3],[1,0,0],[2,0,0],[4,0,0],[0,1,3],[0,0,3],[1,0,0],[3,0,0],[3,1,2],[4,1,2],[3,3,2],[2,3,1],[3,3,1],[1,3,1],[2,3,1],[1,1,3],[2,0,3],[0,1,1],[0,0,1],[0,2,2],[0,1,2],[1,2,0],[3,3,0],[4,3,0],[3,2,0],[4,0,3],[4,1,3],[3,0,1],[1,0,1],[1,1,2],[2,1,0],[2,2,2],[3,3,2],[2,3,1],[0,2,1],[0,0,3],[0,1,3],[1,1,0],[1,0,0],[2,1,0],[2,0,0],[4,0,0],[4,2,2],[4,1,2],[3,2,1],[3,3,1],[1,2,1],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,1,0],[1,0,0],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,0,3],[2,1,3],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
[[3,3,0],[4,3,0],[4,2,3],[1,1,0],[2,2,1],[2,0,3],[0,0,1],[0,1,2],[0,2,2],[2,3,0],[1,3,0],[3,3,0],[2,3,0],[4,3,0],[3,3,0],[3,2,3],[3,0,3],[1,0,1],[0,0,1],[4,0,3],[2,0,1],[1,0,1],[0,1,2],[1,3,2],[1,2,0],[2,3,0],[1,3,2],[3,3,0],[2,3,0],[3,1,3],[4,1,3],[3,0,3],[2,0,1],[2,1,2],[1,2,1],[0,2,1],[0,3,2],[1,3,0],[2,2,3],[2,0,3],[3,0,0],[3,1,2],[3,2,2],[2,3,1],[4,2,2],[3,3,1],[2,1,3],[2,0,3],[3,1,3],[2,1,1],[2,2,2],[2,1,2],[3,2,0],[4,3,0],[3,3,2],[4,1,3],[3,1,1],[3,2,2],[2,2,1],[2,0,3],[2,1,3],[3,1,0],[4,1,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[3,1,3],[2,1,1],[2,2,2],[0,3,1],[0,2,3],[1,3,1],[1,2,3],[0,0,3],[2,0,0],[3,1,2],[1,0,0],[3,0,0],[4,0,0],[4,2,2],[2,3,1],[2,1,3],[2,0,3],[4,1,2],[3,2,1],[0,0,1],[3,0,3],[1,0,1],[0,1,2],[0,3,2],[1,3,0],[2,2,0],[2,1,3],[3,3,0],[4,2,3],[4,0,3],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[0,3,2],[0,2,2],[1,2,0],[2,2,0],[1,2,3],[1,0,3],[0,0,1],[1,0,1],[0,1,2],[0,0,1],[0,2,2],[1,3,0],[0,1,2],[0,3,2],[2,3,0],[4,3,0],[1,3,0],[3,3,0],[4,1,3],[3,1,3],[3,0,3],[2,0,1],[3,0,1],[1,0,1],[2,0,1],[1,1,2],[0,2,1],[2,3,2],[0,3,1],[0,0,3],[0,1,3],[1,0,0],[3,0,0],[4,0,0],[3,1,0],[4,2,2],[4,1,2],[3,2,1],[1,3,1],[1,2,3],[2,2,0],[2,1,3],[3,0,3],[2,0,1],[0,0,1],[0,2,2],[1,3,0],[0,1,2],[1,2,0],[2,3,0],[2,2,0],[4,2,0],[4,0,3],[4,1,3],[3,1,1],[3,0,1],[1,0,1],[0,0,1],[0,2,2],[0,3,2],[0,1,2],[0,2,2],[1,3,0],[1,2,0],[3,2,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
//4H
[[2,1,2],[4,3,0],[2,2,2],[3,3,0],[3,2,3],[3,0,3],[2,0,1],[4,0,3],[3,0,1],[2,1,2],[2,3,2],[3,1,2],[2,2,1],[2,0,3],[2,1,3],[3,0,0],[4,0,0],[3,0,3],[4,1,2],[3,2,1],[3,1,3],[2,0,1],[2,2,2],[2,1,2],[3,2,0],[4,2,0],[3,3,0],[4,0,3],[4,1,3],[3,0,1],[2,0,1],[1,0,1],[0,1,1],[1,1,2],[0,2,2],[2,3,0],[1,3,0],[2,2,3],[3,2,0],[3,0,3],[3,1,3],[2,0,1],[2,2,2],[2,1,2],[0,1,1],[0,0,3],[0,1,3],[1,0,0],[2,0,0],[0,0,3],[1,0,0],[1,1,2],[0,2,1],[1,2,1],[0,3,2],[2,3,0],[1,3,0],[2,2,3],[2,3,0],[3,2,0],[3,0,3],[3,1,3],[1,0,1],[0,1,1],[1,1,2],[0,2,2],[1,3,2],[1,2,0],[2,2,0],[3,2,0],[4,2,0],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[1,2,1],[0,2,1],[1,2,3],[0,1,3],[0,0,3],[1,0,0],[2,0,0],[2,2,2],[1,3,1],[0,3,1],[2,1,2],[2,3,2],[1,3,1],[0,2,3],[0,1,3],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[2,0,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[2,3,1],[2,2,1],[1,2,1],[0,2,1],[0,3,1],[0,0,3],[0,1,3],[1,0,0],[2,0,0],[3,2,2],[3,3,2],[3,1,2],[3,2,2],[4,2,0],[4,0,3],[4,1,3],[3,1,1],[3,0,1],[1,0,1],[0,0,1],[0,2,2],[0,1,2],[1,2,0],[2,2,0],[1,3,0],[3,2,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[2,2,3],[4,0,0],[2,0,3],[3,0,0],[3,1,2],[3,2,2],[2,3,1],[4,2,2],[3,3,1],[2,1,3],[2,0,3],[3,1,3],[2,1,1],[2,2,2],[2,1,2],[3,2,0],[4,3,0],[3,3,2],[4,1,3],[3,1,1],[3,2,2],[2,2,1],[2,0,3],[2,1,3],[3,1,0],[4,1,0],[3,0,0],[4,2,2],[4,1,2],[3,2,1],[2,2,1],[1,2,1],[0,2,1],[1,2,3],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[3,1,0],[3,2,2],[3,1,2],[2,2,1],[2,1,3],[2,2,3],[0,1,1],[0,3,2],[0,2,2],[1,3,0],[2,3,0],[0,3,2],[1,3,0],[1,1,3],[0,1,1],[1,1,1],[0,0,3],[2,0,0],[1,0,0],[2,1,2],[2,0,0],[3,0,0],[3,2,2],[3,1,2],[1,2,1],[0,2,1],[1,2,3],[0,1,3],[1,0,3],[1,1,0],[2,0,0],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[2,2,1],[2,0,3],[2,1,3],[1,0,1],[0,1,1],[1,1,2],[0,2,2],[0,3,2],[1,3,0],[2,2,0],[2,0,3],[1,0,1],[0,0,1],[2,1,3],[2,0,3],[1,0,1],[0,1,2],[0,2,2],[0,1,1],[0,3,2],[0,2,2],[1,2,0],[2,2,0],[3,2,0],[4,0,3],[4,1,3],[3,0,1],[2,0,1],[2,1,1],[1,1,1],[0,1,1],[0,0,1],[0,2,2],[0,1,2],[1,2,0],[2,2,0],[3,1,3],[3,0,3],[3,2,3],[3,1,3],[4,0,0],[4,2,2],[4,1,2],[3,2,1],[3,3,1],[1,2,1],[0,2,1],[0,0,3],[0,1,3],[1,1,0],[2,1,0],[1,0,0],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,0,3],[2,1,3],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
//5H
[[4,2,3],[3,1,2],[4,0,3],[3,0,1],[2,0,1],[2,2,2],[2,1,2],[0,2,1],[0,1,3],[0,0,3],[0,2,3],[0,1,3],[1,0,0],[2,0,0],[3,0,0],[3,2,2],[3,1,2],[1,2,1],[0,2,1],[0,3,1],[0,0,3],[0,1,3],[1,0,0],[1,2,2],[1,1,2],[1,3,2],[1,2,2],[2,2,0],[3,0,3],[3,1,3],[2,0,1],[1,0,1],[1,1,1],[0,0,1],[0,2,2],[0,1,2],[1,2,0],[2,1,3],[2,0,3],[2,2,3],[2,1,3],[3,0,0],[3,2,2],[3,1,2],[2,2,1],[2,3,1],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[2,0,0],[3,0,0],[4,0,0],[4,1,2],[3,2,1],[3,3,2],[3,2,2],[1,2,1],[1,0,3],[1,1,3],[2,0,0],[3,1,0],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,1,3],[2,2,3],[2,0,3],[2,1,3],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
[[4,1,2],[3,2,3],[4,2,2],[3,3,1],[2,2,1],[2,0,3],[2,1,3],[0,0,1],[0,2,2],[0,3,2],[0,1,2],[0,2,2],[1,2,0],[2,2,0],[3,2,0],[3,0,3],[3,1,3],[1,0,1],[0,1,1],[0,0,1],[0,2,2],[0,1,2],[1,2,0],[1,1,3],[1,2,3],[1,0,3],[1,1,3],[2,0,0],[3,2,2],[3,1,2],[2,2,1],[1,3,1],[1,2,1],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[2,2,2],[2,3,2],[2,1,2],[2,2,2],[3,2,0],[3,0,3],[3,1,3],[2,1,1],[2,0,1],[0,0,1],[0,2,2],[0,1,2],[1,2,0],[2,2,0],[3,2,0],[4,3,0],[4,1,3],[3,1,1],[3,0,3],[3,1,3],[1,0,1],[1,2,2],[1,1,2],[2,2,0],[3,3,0],[3,2,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,3,2],[2,1,2],[2,2,2],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[0,1,2],[2,2,0],[2,3,2],[1,2,0],[2,2,0],[2,0,3],[2,1,3],[0,0,1],[0,2,2],[1,2,0],[1,3,2],[0,1,2],[0,2,2],[1,2,0],[2,2,0],[3,2,0],[3,0,3],[3,1,3],[1,0,1],[1,2,2],[0,3,1],[1,1,2],[0,2,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[2,0,0],[3,2,2],[3,1,2],[2,2,1],[1,3,1],[1,2,1],[0,3,1],[0,2,1],[0,0,3],[0,1,3],[1,0,0],[2,2,2],[2,3,2],[2,1,2],[2,2,2],[3,2,0],[3,0,3],[3,1,3],[2,1,1],[2,0,1],[0,0,1],[0,2,2],[1,3,0],[0,1,2],[1,2,0],[2,2,0],[3,2,0],[4,2,0],[4,0,3],[4,1,3],[3,1,1],[3,0,1],[1,0,1],[1,2,2],[1,1,2],[2,2,0],[3,2,0],[4,2,0],[4,1,3],[4,2,3],[4,0,3],[4,1,3],[2,0,1],[2,2,2],[2,1,2],[3,2,0],[4,2,0],[3,2,3],[3,0,3],],
[[0,1,3],[1,0,3],[1,1,0],[2,1,0],[2,0,0],[2,2,2],[2,1,2],[0,2,1],[0,1,3],[0,0,3],[0,2,3],[0,1,3],[1,1,0],[1,0,0],[2,0,0],[3,0,0],[3,2,2],[3,1,2],[1,2,1],[0,2,1],[0,3,1],[0,1,3],[0,2,3],[0,0,3],[0,1,3],[1,0,0],[2,0,0],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[2,2,1],[1,2,1],[1,3,1],[1,0,3],[1,1,3],[2,0,0],[2,2,2],[2,1,2],[2,3,2],[2,2,2],[3,2,0],[4,0,3],[4,1,3],[3,0,1],[2,0,1],[2,1,1],[1,0,1],[1,2,2],[1,1,2],[2,2,0],[3,1,3],[3,0,3],[3,2,3],[3,1,3],[4,0,0],[4,2,2],[4,1,2],[3,2,1],[3,3,1],[1,2,1],[1,0,3],[1,1,3],[2,0,0],[3,0,0],[4,0,0],[4,2,2],[4,1,2],[4,3,2],[4,2,2],[2,2,1],[2,0,3],[2,1,3],[3,0,0],[4,1,0],[3,1,2],[3,2,2],],
],

level: 0,
      imgClass: ["sprite bg-caocao",["sprite bg-guanyuH","sprite bg-huangzhongH","sprite bg-machaoH","sprite bg-zhaoyunH","sprite bg-zhangfeiH"],["sprite bg-zhangfeiV","sprite bg-zhaoyunV","sprite bg-machaoV","sprite bg-huangzhongV","sprite bg-guanyuV"],"sprite bg-bing"],
      CW: 60,
      CH: 60,
      grid: [],
      caocaoItem: null,
      currentCube: null,
      chooseCube: null,
      gameCon: null,
      moveInfo: [],
      steps: 0,
      neighbors: [[-1,0],[1,0],[0,-1],[0,1]],//上下左右
      
      dialog: false,
      maxLev: '',
      type: '',
      }
    },
    mounted: function(){
      this.klotski("game-klotski");
    },
    methods: {
      newPuzzles(data) {
        // console.log('data:::', data)
        // console.log("Max level", this.maxLev, this.type)
        if(this.type==='') {
          this.dialog = false;
          return;
        }
        generatePuzzles(["Klotski.exe", this.maxLev, this.type]).then(response => {
          console.log(response);
          this.MAP = response["MAP"];
          this.sol = response["sol"];
          this.level = 0, this.steps = 0;
          this.dialog = false;
          let last=document.getElementById("lastLevel"),
              next=document.getElementById("nextLevel");
          last.style.visibility="hidden";
          next.style.visibility="visible";
          this.replay();
        });
      },
      changeLevel(e){
        if(e.currentTarget.id=="nextLevel") this.level++;
        else this.level--;
        if(this.level==this.MAP.length-1||this.level==0) {
          e.currentTarget.style.visibility="hidden";
          if(this.MAP.length==2){//special case: only two maps
            let last=document.getElementById("lastLevel"),
                next=document.getElementById("nextLevel");
            if(this.level==1) last.style.visibility="visible";
            else next.style.visibility="visible";
          }
          this.level = this.level%this.MAP.length;
        }
        else {
          var last=document.getElementById("lastLevel"),
              next=document.getElementById("nextLevel");
          last.style.visibility="visible";
          next.style.visibility="visible";
        }
        this.replay();
      },
      replay(){
        this.klotski("game-klotski");
      },
      klotski(id){
        const thisPage = this;
        var div=document.getElementById(id);
        if(this.gameCon != null) this.gameCon.remove();//remove gameCon for replaying
        this.gameCon = this.creatCube(this.CW*4,this.CH*5,0,0);
        this.gameCon.style.cursor="pointer";
        div.appendChild(this.gameCon);
        if(this.chooseCube != null) this.chooseCube.remove();//remove chooseCube for replaying
        this.chooseCube = this.creatCube(this.CW,this.CH,0,0);
        this.chooseCube.style.display="none";
        this.chooseCube.style.border="solid 2px #cc00cc";
        div.appendChild(this.chooseCube);
        
        this.initGame();

        //auto play
        var _button=document.createElement("input");
        _button.type = "button";
        _button.className = "options";
        _button.value = "Solution";

        _button.addEventListener("click",this.autoPlay);  

        //(div.parentElement.parentElement).appendChild(_button);

        var _button1=document.createElement("input");
        _button1.type = "button";
        _button1.className = "options";
        _button1.value = "Move back";

        _button1.addEventListener("click",this.moveBack);  

        //(div.parentElement.parentElement).appendChild(_button1);

        this.gameCon.onclick=function(e){
          //计算鼠标点击位置相对于gameCon的坐标
          var o=thisPage.getPos(thisPage.gameCon);
          var x=e.clientX-o.left+document.documentElement.scrollLeft;
          var y=e.clientY-o.top+document.documentElement.scrollTop;
          //点击位置的索引坐标
          var p=thisPage.xy2ij(x,y);
          if(thisPage.grid[p.i][p.j]!=0){ 
            thisPage.currentCube=thisPage.grid[p.i][p.j];
            thisPage.chooseCube.style.display="block";
            thisPage.updateChooseCube();
          }
          else{ 
            if(thisPage.currentCube){ 
              if(thisPage.checkMove(thisPage.currentCube,p.i,p.j)){
                thisPage.updateChooseCube();
                thisPage.updateCube(thisPage.currentCube);
                thisPage.checkWin();
              }
            }
          }
        }
        if(this.MAP.length==1){
          var next=document.getElementById("nextLevel");
          next.style.visibility="hidden";
        }
      },
      autoPlay(){
          this.replay();
          console.log("autoPlay...");
          var solution = this.sol[this.level];
          for(let i = 0; i < solution.length; i++){
            setTimeout(() => {
              console.log(i);
              this.autoMove(solution[i][0],solution[i][1],solution[i][2]);
            }, 100 * i);
          }
        },
        autoMove(i, j, dir){
          if(this.grid[i][j]!=0){
            this.currentCube=this.grid[i][j];
            this.chooseCube.style.display="block";
            this.updateChooseCube();
            if(this.moveAble(this.currentCube,dir)){
              this.move(this.currentCube, dir);
              this.updateCube(this.currentCube);
              this.updateChooseCube();
              this.checkWin();
            }
          }
        },

        checkWin(){
          if(this.isWin()){
            setTimeout(() => {
                alert("Congratulations! You solved the puzzle in " + this.steps + " moves.");
            }, 100);
            //initGame();
          }
        },
        isWin(){
          if(this.caocaoItem.p[0]==3&&this.caocaoItem.p[1]==1)return true;
          return false;
        },
        updateCube(item){
          var xy=this.ij2xy(item.p[0],item.p[1]);
          item.style.left=xy.x+"px";
          item.style.top=xy.y+"px";
        },
        updateChooseCube(){
          this.chooseCube.style.width=this.currentCube.style.width;
          this.chooseCube.style.height=this.currentCube.style.height;
          var xy=this.ij2xy(this.currentCube.p[0],this.currentCube.p[1]);
          this.chooseCube.style.left=xy.x+"px";
          this.chooseCube.style.top=xy.y+"px";
        },
        checkMove(item,I,J){
          var ps="none";
          for(var s in item.a){ 
            var b=item.a[s];
            var i=item.p[0]+b[0];
            var j=item.p[1]+b[1];
            if(i==I&&Math.abs(J-j)==1){
              ps=(J-j)>0?"right":"left";
              break;
            }
            else if(j==J&&Math.abs(I-i)==1){
              ps=(I-i)>0?"down":"up";
              break;
            }
          }
          var flag=false;
          switch(ps){ 
            case "left":
            if(this.moveAble(item,2)){
              this.move(item,2);
              flag=true;
            }
            break;
            case "right":
            if(this.moveAble(item,3)){
              this.move(item,3);
              flag=true;
            }
            break;
            case "up":
            if(this.moveAble(item,0)){
              this.move(item,0);
              flag=true;
            }
            break;
            case "down":
            if(this.moveAble(item,1)){
              this.move(item,1);
              flag=true;
            }
            break;
          }
          return flag;
        },
        move(item,pos){
          for(let s in item.a){
            let b=item.a[s];
            let i=b[0]+item.p[0];
            let j=b[1]+item.p[1];
            this.grid[i][j]=0;
          }
          item.p=[item.p[0]+this.neighbors[pos][0],item.p[1]+this.neighbors[pos][1]];
          for(let s in item.a){
            let b=item.a[s];
            let i=b[0]+item.p[0];
            let j=b[1]+item.p[1];
            this.grid[i][j]=item;
          }
          this.moveInfo.push([item, pos]);
          this.steps++;
        },
        moveBack(){
          if(this.moveInfo.length!=0){
            var lastInfo = this.moveInfo.pop();
            this.currentCube= lastInfo[0];
            this.chooseCube.style.display="block";
            var pos = lastInfo[1]%2==0? lastInfo[1]+1 : lastInfo[1]-1;
            this.move(lastInfo[0], pos);
            this.steps-=2;//reverse move data
            this.moveInfo.pop();
            this.updateCube(this.currentCube);
            this.updateChooseCube();
            this.checkWin();
          }
        },
        moveAble(item,pos){ 
          for(var s in item.a){ 
            var b=item.a[s];
            var i=b[0]+item.p[0]+this.neighbors[pos][0];
            var j=b[1]+item.p[1]+this.neighbors[pos][1];
            if(this.grid[i][j]!=0&&this.grid[i][j]!=item){ 
              return false;
            }
          }
          return true;
        },

        ij2xy(i,j){ 
          return { x:j*this.CW,y:i*this.CH };
        },
        
        xy2ij(x,y){ 
          return {i:parseInt(y/this.CW),j:parseInt(x/this.CH)};
        },
        
        initGame(){
          this.moveInfo = [], this.grid = [];
          this.steps = 0;
          var n=0, m=0;//idx for img classes (horizontal&vertical)
          this.cloneMap();
          this.gameCon.innerHTML="";
          this.chooseCube.style.display="none";
          for(var i=0;i<this.grid.length;i++){
            for(var j=0;j<this.grid[i].length;j++){
              var value=this.grid[i][j];
              var item=null;
              if(value==3){ 
                item=this.zhangfei(i,j,this.imgClass[2][n]);n++;
              }
              else if(value==1){ 
                item=this.bing(i,j,this.imgClass[3]);
              }
              else if(value==2){ 
                item=this.guanyu(i,j,this.imgClass[1][m]);m++;
              }
              else if(value==4){ 
                this.caocaoItem=item=this.caocao(i,j,this.imgClass[0]);
              }
              if(item){ 
                for(var s in item.a){
                  var a=item.a[s];
                  this.grid[i+a[0]][j+a[1]]=item;
                }
                this.gameCon.appendChild(item);
              }
            }
          }
        },
        
        cloneMap(){
          var map = this.MAP[this.level];
          for(var i=0;i<map.length;i++){
            this.grid[i]=[];
            for(var j=0;j<map[i].length;j++){
              this.grid[i][j]=map[i][j];
            }
          }
        },
        
        bing(i,j,c){ 
          var d=this.creatCube(this.CW-2,this.CH-2,j*this.CW,i*this.CH);
          d.p=[i,j];
          d.a=[[0,0]];
          d.className=c;
          return d;		
        },
        zhangfei(i,j,c){ 
          var d=this.creatCube(this.CW-2,this.CH*2-2,j*this.CW,i*this.CH);
          d.p=[i,j];
          d.a=[[0,0],[1,0]];
          d.className=c;
          return d;
        },
        guanyu(i,j,c){ 
          var d=this.creatCube(this.CW*2-2,this.CH-2,j*this.CW,i*this.CH);
          d.p=[i,j];
          d.a=[[0,0],[0,1]];
          d.className=c;
          return d;
        },
        caocao(i,j,c){ 
          var d=this.creatCube(this.CW*2-2,this.CH*2-2,j*this.CW,i*this.CH);
          d.p=[i,j];
          d.a=[[0,0],[1,0],[1,1],[0,1]];
          d.className=c;
          return d;
        },
        creatCube(w,h,x,y){ 
          var c=document.createElement("div");
          c.style.position="absolute";
          c.style.left=x+"px";
          c.style.top=y+"px";
          c.style.width=w+"px";
          c.style.height=h+"px";
          c.style.overflow="hidden";
          return c;
        },
        getPos(obj){ 
          var parentObj=obj;
          var left=obj.offsetLeft;
          var top=obj.offsetTop;
          while((parentObj=parentObj.offsetParent)!=null){ 
            left+=parentObj.offsetLeft;
            top+=parentObj.offsetTop;
          }
          return {left:left,top:top};
        }
    }
  }

</script>

<style>
  .gameboard {
    width: 640px;
    height: 480px;
    position: relative;
    left: 50%;
    margin-left: -320px;  
    background-image:url(../assets/background.jpg);
  }
  .options {
    position: relative;
    left: 30%;
  }
  #lastLevel{
    position: absolute;
    left: 21%;
    top: 10%;
    width: 22px; height: 44px;
    background-image:url(../assets/arrow.png);
    background-position: 0px 0px;
    z-index:1;
    visibility: hidden;
  }
  #level {
    position: absolute;
    left: 20%;
    top: 5%;
    width: 108px; height: 75px;
    font:bold, "sans-serif", 20px;
    color: white;
    text-align: center;
    background-image:url(../assets/level.png);
  }
  #nextLevel{
    position: absolute;
    left: 32%;
    top: 10%;
    width: 22px; height: 44px;
    background-image:url(../assets/arrow.png);
    background-position: -22px 0px;
    z-index:1;
  }
  .step {
    position: absolute;
    left: 20%;
    top: 25%;
    width: 108px; height: 75px;
    font:bold, "sans-serif", 20px;
    color: white;
    text-align: center;
    background-image:url(../assets/step.png);
  }
  .back {
    position: absolute;
    left: 20%;
    top: 45%;
    width: 46px; height: 46px;
    text-align: center;
    background-image:url(../assets/back.png);
  }
  .solution {
    position: absolute;
    left: 30%;
    top: 45%;
    width: 46px; height: 46px;
    text-align: center;
    background-image:url(../assets/solution.png);
  }
  .restart {
    position: absolute;
    left: 20%;
    top: 60%;
    width: 47px; height: 47px;
    text-align: center;
    background-image:url(../assets/restart.png);
  }
  .setting {
    position: absolute;
    left: 30%;
    top: 60%;
    width: 46px; height: 46px;
    text-align: center;
    background-image:url(../assets/setting.png);
  }
  .sprite {position:absolute;display:inline-block;text-align: center;overflow:hidden; background-repeat: no-repeat;background-image:url(../assets/css_sprites.png);}

  .bg {width:50px; height:50px; background-position: -158px -458px}
  /* .bing {width:50px; height:50px; background-position: -106px -458px}
  .caocao {width:100px; height:100px; background-position: -2px -304px}
  .guanyu {width:100px; height:50px; background-position: -106px -406px}
  .huangzhong {width:50px; height:100px; background-position: -2px -406px}
  .kuang {width:240px; height:300px; background-position: -2px -2px}
  .machao {width:50px; height:100px; background-position: -156px -304px}
  .zhangfei {width:50px; height:100px; background-position: -54px -406px}
  .zhaoyun {width:50px; height:100px; background-position: -104px -304px} */

.bg-bing {
    width: 59px; height: 62px;
    background-position: -236px -341px;
}

.bg-caocao {
    width: 117px; height: 117px;
    background-position: -280px -0;
}

.bg-guangyuV {
    width: 59px; height: 117px;
    background-position: -393px -130px;
}

.bg-guanyuH {
    width: 117px; height: 63px;
    background-position: -280px -124px;
}

.bg-huangzhongH {
    width: 117px; height: 63px;
    background-position: -281px -188px;
}

.bg-huangzhongV {
    width: 59px; height: 117px;
    background-position: -0 -337px;
}

.bg-machaoH {
    width: 117px; height: 63px;
    background-position: -280px -250px;
}

.bg-machaoV {
    width: 59px; height: 117px;
    background-position: -59px -337px;
}

.bg-restart {
    width: 39px; height: 39px;
    background-position: -452px -126px;
}

.bg-solution {
    width: 34px; height: 34px;
    background-position: -452px -199px;
}

.bg-stop {
    width: 34px; height: 34px;
    background-position: -295px -333px;
}

.bg-zhangfeiH {
    width: 117px; height: 63px;
    background-position: -400px -7px;
}

.bg-zhangfeiV {
    width: 59px; height: 117px;
    background-position: -118px -337px;
}

.bg-zhaoyunH {
    width: 117px; height: 63px;
    background-position: -398px -70px;
}

.bg-zhaoyunV {
    width: 59px; height: 117px;
    background-position: -177px -337px;
}

.bg-kuang {
    left: 60%; top: 50%;
    margin-left: -138px; margin-top: -166px;
    position: relative;
    width: 276px; height: 333px;
    background-position: -0 -0;
}
</style>
